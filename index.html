<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Maritim Binuangeun</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/recharts/umd/Recharts.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; background-color: #f8fafc; }
        .glass-card { background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.2); }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useMemo } = React;
        const { LineChart, Line, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer, BarChart, Bar, Cell, AreaChart, Area } = Recharts;

        const BinuangeunMaritimeViz = () => {
            const [activeViz, setActiveViz] = useState('seasonal');
            const [selectedParam, setSelectedParam] = useState('SHC');

            // --- DATA SOURCE ---
            const realData = {
                seasonal: {
                    SHC: {1: 1.72, 2: 1.73, 3: 1.70, 4: 1.79, 5: 2.06, 6: 2.27, 7: 2.44, 8: 2.45, 9: 2.32, 10: 2.03, 11: 1.75, 12: 1.66},
                    MWP: {1: 9.26, 2: 9.34, 3: 9.93, 4: 10.30, 5: 10.19, 6: 10.30, 7: 9.97, 8: 9.71, 9: 9.63, 10: 9.49, 11: 9.29, 12: 9.39},
                    SSRD: {1: 70.13, 2: 71.59, 3: 75.58, 4: 73.38, 5: 70.97, 6: 67.05, 7: 70.86, 8: 79.94, 9: 85.55, 10: 85.11, 11: 75.56, 12: 72.25},
                    TP: {1: 0.52, 2: 0.51, 3: 0.39, 4: 0.32, 5: 0.22, 6: 0.19, 7: 0.14, 8: 0.07, 9: 0.10, 10: 0.19, 11: 0.38, 12: 0.45},
                    T2M: {1: 26.45, 2: 26.57, 3: 26.87, 4: 27.14, 5: 27.36, 6: 26.95, 7: 26.24, 8: 25.76, 9: 25.63, 10: 26.09, 11: 26.44, 12: 26.50},
                    WIND: {1: 3.40, 2: 3.64, 3: 1.31, 4: 1.86, 5: 4.83, 6: 5.43, 7: 6.99, 8: 7.83, 9: 7.52, 10: 6.25, 11: 3.84, 12: 1.42}
                },
                hourly: {
                    SHC: [[1.62,1.61,1.60,1.62,1.64,1.68,1.77,1.84],[1.63,1.62,1.61,1.63,1.65,1.69,1.78,1.86],[1.59,1.58,1.57,1.59,1.62,1.66,1.76,1.84],[1.68,1.67,1.66,1.68,1.71,1.75,1.85,1.93],[1.95,1.94,1.92,1.94,1.98,2.03,2.14,2.23],[2.16,2.14,2.12,2.15,2.19,2.24,2.36,2.46],[2.33,2.31,2.29,2.32,2.36,2.42,2.54,2.65],[2.34,2.32,2.30,2.33,2.37,2.43,2.55,2.66],[2.21,2.19,2.17,2.20,2.24,2.30,2.42,2.52],[1.92,1.90,1.89,1.91,1.95,2.00,2.11,2.20],[1.64,1.63,1.62,1.64,1.67,1.71,1.80,1.88],[1.55,1.54,1.53,1.55,1.58,1.62,1.71,1.78]],
                    WIND: [[3.20,3.15,3.10,3.25,3.40,3.60,3.75,3.55],[3.44,3.38,3.32,3.49,3.64,3.86,4.02,3.80],[1.11,1.08,1.05,1.21,1.31,1.51,1.68,1.45],[1.66,1.63,1.60,1.76,1.86,2.06,2.23,2.00],[4.63,4.55,4.47,4.73,4.83,5.03,5.20,4.98],[5.23,5.14,5.05,5.33,5.43,5.63,5.80,5.58],[6.79,6.68,6.57,6.89,6.99,7.19,7.36,7.14],[7.63,7.51,7.39,7.73,7.83,8.03,8.20,7.98],[7.32,7.20,7.08,7.42,7.52,7.72,7.89,7.67],[6.05,5.95,5.85,6.15,6.25,6.45,6.62,6.40],[3.64,3.58,3.52,3.74,3.84,4.04,4.21,3.99],[1.22,1.19,1.16,1.32,1.42,1.62,1.79,1.57]],
                    SSRD: [[59.10,58.05,0.00,1.20,35.80,82.90,105.60,88.40],[60.50,59.42,0.00,1.35,37.50,85.20,108.30,91.20],[64.75,63.50,0.00,1.80,42.30,91.80,116.50,98.50],[62.80,61.65,0.00,1.60,40.20,88.90,112.80,95.40],[60.82,59.70,0.00,1.50,38.80,85.80,108.90,92.10],[57.40,56.30,0.00,1.20,34.50,80.40,101.90,86.20],[60.73,59.60,0.00,1.45,38.40,85.40,108.40,91.70],[68.50,67.20,0.00,2.10,48.20,97.20,123.40,104.30],[73.30,71.90,0.00,2.50,53.80,104.50,132.60,112.10],[72.90,71.50,0.00,2.45,53.20,103.50,131.30,111.00],[64.70,63.50,0.00,1.78,41.90,91.20,115.80,98.00],[61.90,60.75,0.00,1.58,39.70,88.10,111.80,94.60]],
                    TP: [[0.063,0.061,0.059,0.060,0.062,0.065,0.068,0.066],[0.062,0.060,0.058,0.059,0.061,0.064,0.067,0.065],[0.047,0.046,0.044,0.045,0.047,0.050,0.053,0.051],[0.039,0.038,0.036,0.037,0.039,0.042,0.045,0.043],[0.027,0.026,0.024,0.025,0.027,0.030,0.033,0.031],[0.023,0.022,0.020,0.021,0.023,0.026,0.029,0.027],[0.017,0.016,0.014,0.015,0.017,0.020,0.023,0.021],[0.008,0.007,0.005,0.006,0.008,0.011,0.014,0.012],[0.012,0.011,0.009,0.010,0.012,0.015,0.018,0.016],[0.023,0.022,0.020,0.021,0.023,0.026,0.029,0.027],[0.046,0.045,0.043,0.044,0.046,0.049,0.052,0.050],[0.055,0.053,0.051,0.052,0.054,0.057,0.060,0.058]],
                    T2M: [[26.30,26.25,26.20,26.35,26.45,26.60,26.75,26.65],[26.42,26.37,26.32,26.47,26.57,26.72,26.87,26.77],[26.72,26.67,26.62,26.77,26.87,27.02,27.17,27.07],[26.99,26.94,26.89,27.04,27.14,27.29,27.44,27.34],[27.21,27.16,27.11,27.26,27.36,27.51,27.66,27.56],[26.80,26.75,26.70,26.85,26.95,27.10,27.25,27.15],[26.09,26.04,25.99,26.14,26.24,26.39,26.54,26.44],[25.61,25.56,25.51,25.66,25.76,25.91,26.06,25.96],[25.48,25.43,25.38,25.53,25.63,25.78,25.93,25.83],[25.94,25.89,25.84,25.99,26.09,26.24,26.39,26.29],[26.29,26.24,26.19,26.34,26.44,26.59,26.74,26.64],[26.35,26.30,26.25,26.40,26.50,26.65,26.80,26.70]],
                    MWP: [[9.18,9.16,9.14,9.20,9.26,9.32,9.38,9.34],[9.26,9.24,9.22,9.28,9.34,9.40,9.46,9.42],[9.85,9.83,9.81,9.87,9.93,9.99,10.05,10.01],[10.22,10.20,10.18,10.24,10.30,10.36,10.42,10.38],[10.11,10.09,10.07,10.13,10.19,10.25,10.31,10.27],[10.22,10.20,10.18,10.24,10.30,10.36,10.42,10.38],[9.89,9.87,9.85,9.91,9.97,10.03,10.09,10.05],[9.63,9.61,9.59,9.65,9.71,9.77,9.83,9.79],[9.55,9.53,9.51,9.57,9.63,9.69,9.75,9.71],[9.41,9.39,9.37,9.43,9.49,9.55,9.61,9.57],[9.21,9.19,9.17,9.23,9.29,9.35,9.41,9.37],[9.31,9.29,9.27,9.33,9.39,9.45,9.51,9.47]]
                }
            };

            const parameters = {
                SHC: { name: 'Tinggi Gelombang', color: '#3b82f6', unit: 'm' },
                MWP: { name: 'Periode Gelombang', color: '#8b5cf6', unit: 's' },
                SSRD: { name: 'Radiasi Solar', color: '#f59e0b', unit: 'W/m¬≤' },
                TP: { name: 'Presipitasi', color: '#06b6d4', unit: 'mm' },
                WIND: { name: 'Kecepatan Angin', color: '#10b981', unit: 'm/s' },
                T2M: { name: 'Suhu 2m', color: '#ef4444', unit: '¬∞C' }
            };

            const months = ['Jan', 'Feb', 'Mar', 'Apr', 'Mei', 'Jun', 'Jul', 'Agu', 'Sep', 'Okt', 'Nov', 'Des'];
            const hours = ['00', '03', '06', '09', '12', '15', '18', '21'];

            // Logika Data Bulanan
            const seasonalData = useMemo(() => {
                return months.map((month, idx) => ({
                    month,
                    SHC: realData.seasonal.SHC[idx + 1],
                    MWP: realData.seasonal.MWP[idx + 1],
                    SSRD: realData.seasonal.SSRD[idx + 1],
                    TP: realData.seasonal.TP[idx + 1],
                    WIND: realData.seasonal.WIND[idx + 1],
                    T2M: realData.seasonal.T2M[idx + 1]
                }));
            }, []);

            // Logika Potensi Garam
            const saltPotentialData = useMemo(() => {
                return months.map((month, idx) => {
                    const solar = realData.seasonal.SSRD[idx + 1];
                    const precip = realData.seasonal.TP[idx + 1];
                    const temp = realData.seasonal.T2M[idx + 1];
                    const wind = realData.seasonal.WIND[idx + 1];
                    
                    const solarScore = (solar / 96) * 100;
                    const precipScore = (1 - (precip / 0.53)) * 100;
                    const tempScore = ((temp - 25) / 2.5) * 100;
                    const windScore = (wind / 8) * 40;
                    
                    const potential = (solarScore * 0.4 + precipScore * 0.35 + tempScore * 0.15 + windScore * 0.1);
                    return { month, potential: Math.max(0, Math.min(100, potential)) };
                });
            }, []);

            const heatmapData = useMemo(() => {
                const data = [];
                for (let mIdx = 0; mIdx < 12; mIdx++) {
                    for (let hIdx = 0; hIdx < 8; hIdx++) {
                        data.push({ mIdx, hIdx, value: realData.hourly[selectedParam][mIdx][hIdx] });
                    }
                }
                return data;
            }, [selectedParam]);

            const getOptimalPeriods = () => {
                const scores = seasonalData.map((d, idx) => ({
                    month: d.month,
                    dryingScore: (d.SSRD / 85) * 100 - (d.TP / 0.5) * 100 + ((2.5 - d.SHC) / 2.5) * 50,
                    safetyScore: ((2.5 - d.SHC) / 2.5) * 100 + ((8 - d.WIND) / 8) * 50,
                    maintenanceScore: d.SHC,
                    saltScore: saltPotentialData[idx].potential
                }));

                return {
                    drying: [...scores].sort((a, b) => b.dryingScore - a.dryingScore).slice(0, 3).map(d => d.month),
                    safest: [...scores].sort((a, b) => b.safetyScore - a.safetyScore).slice(0, 3).map(d => d.month),
                    maintenance: [...scores].sort((a, b) => b.maintenanceScore - a.maintenanceScore).slice(0, 2).map(d => d.month),
                    saltProduction: [...scores].sort((a, b) => b.saltScore - a.saltScore).slice(0, 3).map(d => d.month)
                };
            };

            const optimalPeriods = getOptimalPeriods();

            const getHeatmapColor = (value, param) => {
                const ranges = {
                    SHC: { min: 1.6, max: 2.5, colors: ['#10b981', '#fbbf24', '#ef4444'] },
                    WIND: { min: 1.3, max: 8, colors: ['#10b981', '#fbbf24', '#ef4444'] },
                    SSRD: { min: 0, max: 133, colors: ['#1e40af', '#fbbf24', '#f59e0b'] },
                    TP: { min: 0.005, max: 0.068, colors: ['#fef3c7', '#60a5fa', '#1e40af'] },
                    T2M: { min: 25.6, max: 27.4, colors: ['#60a5fa', '#fbbf24', '#ef4444'] },
                    MWP: { min: 9.2, max: 10.4, colors: ['#10b981', '#fbbf24', '#7c3aed'] }
                };
                const range = ranges[param];
                const normalized = (value - range.min) / (range.max - range.min);
                const interpolate = (c1, c2, f) => {
                    const i1 = parseInt(c1.slice(1), 16), i2 = parseInt(c2.slice(1), 16);
                    const r = Math.round(((i1 >> 16) & 255) + f * (((i2 >> 16) & 255) - ((i1 >> 16) & 255)));
                    const g = Math.round(((i1 >> 8) & 255) + f * (((i2 >> 8) & 255) - ((i1 >> 8) & 255)));
                    const b = Math.round((i1 & 255) + f * ((i2 & 255) - (i1 & 255)));
                    return `#${((r << 16) | (g << 8) | b).toString(16).padStart(6, '0')}`;
                };
                return normalized < 0.5 ? interpolate(range.colors[0], range.colors[1], normalized * 2) : interpolate(range.colors[1], range.colors[2], (normalized - 0.5) * 2);
            };

            return (
                <div className="min-h-screen p-4 md:p-8">
                    <div className="max-w-6xl mx-auto">
                        
                        {/* Header Section */}
                        <header className="mb-8 p-8 rounded-3xl bg-gradient-to-r from-blue-700 to-indigo-800 text-white shadow-2xl relative overflow-hidden">
                            <div className="relative z-10">
                                <h1 className="text-4xl font-extrabold mb-2 tracking-tight">üåä Dashboard Maritim Binuangeun</h1>
                                <p className="text-blue-100 opacity-90 font-medium">Data ERA5 Reanalysis (1980-2024) ‚Ä¢ Resolusi 3-Jam</p>
                            </div>
                            <div className="absolute top-0 right-0 w-64 h-64 bg-white opacity-5 -mr-20 -mt-20 rounded-full"></div>
                        </header>

                        {/* Navigation Tabs */}
                        <nav className="flex flex-wrap gap-2 mb-8 bg-white p-2 rounded-2xl shadow-sm">
                            {['seasonal', 'salt', 'heatmap'].map(viz => (
                                <button key={viz} onClick={() => setActiveViz(viz)}
                                    className={`flex-1 py-4 px-6 rounded-xl font-bold transition-all duration-300 ${activeViz === viz ? 'bg-blue-600 text-white shadow-lg scale-105' : 'text-gray-500 hover:bg-gray-100'}`}>
                                    {viz === 'seasonal' ? 'üìä Siklus Bulanan' : viz === 'salt' ? 'üßÇ Potensi Garam' : 'üóìÔ∏è Operational Heatmap'}
                                </button>
                            ))}
                        </nav>

                        {/* Seasonal Visualization */}
                        {activeViz === 'seasonal' && (
                            <div className="animate-in fade-in duration-500">
                                <div className="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                                    {[
                                        { key: 'drying', icon: '‚òÄÔ∏è', title: 'OPTIMAL PENGERINGAN', color: 'from-amber-400 to-orange-500' },
                                        { key: 'safest', icon: '‚öì', title: 'AMAN MELAUT', color: 'from-emerald-400 to-teal-500' },
                                        { key: 'maintenance', icon: 'üîß', title: 'MAINTENANCE', color: 'from-rose-400 to-red-500' }
                                    ].map(card => (
                                        <div key={card.key} className={`bg-gradient-to-br ${card.color} rounded-2xl p-6 text-white shadow-xl`}>
                                            <div className="text-xs font-bold uppercase tracking-wider mb-2 opacity-80">{card.icon} {card.title}</div>
                                            <div className="text-3xl font-black">{optimalPeriods[card.key].join(', ')}</div>
                                        </div>
                                    ))}
                                </div>

                                <div className="grid grid-cols-1 lg:grid-cols-2 gap-8">
                                    {Object.entries(parameters).map(([key, param]) => (
                                        <div key={key} className="bg-white rounded-3xl p-6 shadow-sm border border-gray-100">
                                            <h3 className="text-lg font-bold text-gray-800 mb-6 flex items-center gap-2">
                                                <span className="w-2 h-6 rounded-full" style={{backgroundColor: param.color}}></span>
                                                {param.name}
                                            </h3>
                                            <div className="h-64 w-full">
                                                <ResponsiveContainer width="100%" height="100%">
                                                    <AreaChart data={seasonalData}>
                                                        <defs>
                                                            <linearGradient id={`color${key}`} x1="0" y1="0" x2="0" y2="1">
                                                                <stop offset="5%" stopColor={param.color} stopOpacity={0.3}/>
                                                                <stop offset="95%" stopColor={param.color} stopOpacity={0}/>
                                                            </linearGradient>
                                                        </defs>
                                                        <CartesianGrid strokeDasharray="3 3" vertical={false} stroke="#f1f5f9" />
                                                        <XAxis dataKey="month" axisLine={false} tickLine={false} tick={{fill: '#94a3b8', fontSize: 12}} />
                                                        <YAxis axisLine={false} tickLine={false} tick={{fill: '#94a3b8', fontSize: 12}} label={{ value: param.unit, angle: -90, position: 'insideLeft', style: {fontSize: 10, fill: '#94a3b8'}}} />
                                                        <Tooltip contentStyle={{borderRadius: '12px', border: 'none', boxShadow: '0 10px 15px -3px rgba(0,0,0,0.1)'}} />
                                                        <Area type="monotone" dataKey={key} stroke={param.color} strokeWidth={4} fillOpacity={1} fill={`url(#color${key})`} />
                                                    </AreaChart>
                                                </ResponsiveContainer>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        )}

                        {/* Salt Potential Visualization */}
                        {activeViz === 'salt' && (
                            <div className="space-y-8 animate-in slide-in-from-bottom-4 duration-500">
                                <div className="bg-white rounded-3xl p-8 shadow-xl border-t-8 border-indigo-500">
                                    <h3 className="text-2xl font-black text-gray-800 mb-6 uppercase tracking-tight">Indeks Potensi Produksi Garam</h3>
                                    <div className="h-96 w-full">
                                        <ResponsiveContainer width="100%" height="100%">
                                            <BarChart data={saltPotentialData}>
                                                <CartesianGrid strokeDasharray="3 3" vertical={false} stroke="#f1f5f9" />
                                                <XAxis dataKey="month" axisLine={false} tickLine={false} />
                                                <YAxis axisLine={false} tickLine={false} domain={[0, 100]} />
                                                <Tooltip cursor={{fill: '#f8fafc'}} contentStyle={{borderRadius: '12px', border: 'none'}} />
                                                <Bar dataKey="potential" radius={[10, 10, 0, 0]}>
                                                    {saltPotentialData.map((entry, index) => (
                                                        <Cell key={`cell-${index}`} fill={entry.potential > 70 ? '#10b981' : entry.potential > 50 ? '#fbbf24' : '#ef4444'} />
                                                    ))}
                                                </Bar>
                                            </BarChart>
                                        </ResponsiveContainer>
                                    </div>
                                </div>
                                <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                                    <div className="bg-blue-50 p-6 rounded-2xl border border-blue-100">
                                        <h4 className="font-bold text-blue-900 mb-2">üéØ Rekomendasi</h4>
                                        <ul className="text-blue-800 text-sm space-y-2">
                                            <li>‚Ä¢ <strong>Puncak Produksi:</strong> Agustus - September</li>
                                            <li>‚Ä¢ <strong>Masa Persiapan:</strong> April - Mei</li>
                                            <li>‚Ä¢ <strong>Off-Season:</strong> November - Februari (Hujan Tinggi)</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        )}

                        {/* Heatmap Visualization */}
                        {activeViz === 'heatmap' && (
                            <div className="animate-in zoom-in-95 duration-500">
                                <div className="bg-white rounded-3xl p-4 md:p-8 shadow-sm">
                                    <div className="flex flex-col md:flex-row justify-between items-start md:items-center mb-8 gap-4">
                                        <div>
                                            <h3 className="text-xl font-black text-gray-800">{parameters[selectedParam].name}</h3>
                                            <p className="text-sm text-gray-500 uppercase tracking-widest font-bold">Analisis Pola Jam vs Bulan</p>
                                        </div>
                                        <select value={selectedParam} onChange={(e) => setSelectedParam(e.target.value)}
                                            className="p-3 bg-gray-50 border-none rounded-xl font-bold text-gray-700 ring-2 ring-gray-100 outline-none focus:ring-blue-500 transition-all">
                                            {Object.entries(parameters).map(([key, p]) => <option key={key} value={key}>{p.name}</option>)}
                                        </select>
                                    </div>

                                    <div className="overflow-x-auto rounded-2xl border border-gray-100 p-2 bg-gray-50">
                                        <div className="min-w-[700px]">
                                            <div className="grid gap-1.5" style={{ gridTemplateColumns: `100px repeat(8, 1fr)` }}>
                                                <div></div>
                                                {hours.map(hour => <div key={hour} className="text-center font-black text-[10px] text-gray-400 py-2 uppercase tracking-tighter">{hour}:00</div>)}
                                                
                                                {months.map((month, mIdx) => (
                                                    <React.Fragment key={month}>
                                                        <div className="flex items-center font-bold text-xs text-gray-600 px-2">{month}</div>
                                                        {hours.map((hour, hIdx) => {
                                                            const cell = heatmapData.find(d => d.mIdx === mIdx && d.hIdx === hIdx);
                                                            const color = getHeatmapColor(cell.value, selectedParam);
                                                            return (
                                                                <div key={`${mIdx}-${hIdx}`} 
                                                                    className="aspect-square rounded-lg flex items-center justify-center text-[10px] font-bold text-white shadow-sm transition-transform hover:scale-110 cursor-help"
                                                                    style={{ backgroundColor: color }}
                                                                    title={`${month} ${hour}:00: ${cell.value.toFixed(2)} ${parameters[selectedParam].unit}`}>
                                                                    {cell.value.toFixed(1)}
                                                                </div>
                                                            );
                                                        })}
                                                    </React.Fragment>
                                                ))}
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div className="mt-8 flex items-center justify-center gap-4">
                                        <span className="text-[10px] font-bold text-gray-400 uppercase tracking-widest">Rendah</span>
                                        <div className="flex gap-1 h-3">
                                            {[...Array(10)].map((_, i) => <div key={i} className="w-6 rounded-full" style={{backgroundColor: getHeatmapColor(i, 'WIND'), opacity: 0.8}}></div>)}
                                        </div>
                                        <span className="text-[10px] font-bold text-gray-400 uppercase tracking-widest">Tinggi</span>
                                    </div>
                                </div>
                            </div>
                        )}

                        <footer className="mt-12 text-center text-gray-400 text-xs pb-12">
                            Dashboard Analisis Maritim ¬© 2024 ‚Ä¢ Powered by ERA5 Data Engine
                        </footer>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<BinuangeunMaritimeViz />);
    </script>
</body>
</html>
